# Lisa老師專屬文案助手 - 測試計劃

## 測試目標
驗證對話記錄使用瀏覽器 localStorage 儲存，確保：
1. 重新整理頁面後對話記錄保留
2. 每個使用者的對話記錄是獨立的
3. localStorage 資料正確讀取與儲存

---

## 測試環境

### 必要條件
- 現代瀏覽器（Chrome、Firefox、Safari、Edge）
- 啟用 JavaScript
- 啟用 localStorage（未使用無痕模式）

---

## 測試案例

### 測試案例 1：基本對話功能
**目的**：驗證基本的對話流程

**步驟**：
1. 開啟應用程式
2. 在輸入框輸入：`你好`
3. 按 Enter 發送
4. 等待 AI 回應

**預期結果**：
- ✅ 使用者訊息顯示在聊天介面
- ✅ AI 回應正確顯示
- ✅ 對話統計顯示訊息數量為 2（1 個使用者訊息 + 1 個 AI 回應）

---

### 測試案例 2：localStorage 儲存驗證
**目的**：驗證對話記錄正確儲存到 localStorage

**步驟**：
1. 完成測試案例 1
2. 開啟瀏覽器開發者工具（F12）
3. 切換到 "Application" 或 "Storage" 分頁
4. 查看 localStorage
5. 尋找 key 為 `lisa_chat_messages` 的項目

**預期結果**：
- ✅ localStorage 中存在 `lisa_chat_messages`
- ✅ 資料格式為 JSON 陣列
- ✅ 陣列包含 2 個物件（使用者訊息 + AI 回應）
- ✅ 每個物件包含 `role` 和 `content` 欄位

**範例資料格式**：
```json
[
  {
    "role": "user",
    "content": "你好"
  },
  {
    "role": "assistant",
    "content": "你好！我是 Lisa 老師的專屬文案助手..."
  }
]
```

---

### 測試案例 3：重新整理頁面後資料保留（核心功能）
**目的**：驗證重新整理頁面後對話記錄保留

**步驟**：
1. 完成測試案例 1（已有對話記錄）
2. 按 F5 或點擊瀏覽器重新整理按鈕
3. 等待頁面完全載入
4. 檢查聊天介面

**預期結果**：
- ✅ 對話記錄完整顯示（使用者訊息 + AI 回應）
- ✅ 對話統計顯示正確的訊息數量
- ✅ 左側邊欄顯示 "✅ 已從瀏覽器載入歷史記錄"

**失敗條件**：
- ❌ 對話記錄消失
- ❌ 只顯示部分對話
- ❌ 對話順序錯誤

---

### 測試案例 4：多輪對話後重新整理
**目的**：驗證多輪對話後重新整理資料完整性

**步驟**：
1. 開啟應用程式
2. 依序輸入以下訊息（每次等待 AI 回應）：
   - `你好`
   - `請幫我寫一段自我介紹`
   - `謝謝`
3. 確認有 6 則訊息（3 個使用者 + 3 個 AI）
4. 重新整理頁面
5. 檢查對話記錄

**預期結果**：
- ✅ 所有 6 則訊息完整顯示
- ✅ 訊息順序正確
- ✅ 訊息內容完整無缺
- ✅ 對話統計顯示 6 則訊息

---

### 測試案例 5：清除對話歷史功能
**目的**：驗證清除功能正確運作

**步驟**：
1. 完成測試案例 4（已有多輪對話）
2. 點擊左側邊欄的 "🗑️ 清除對話歷史" 按鈕
3. 檢查聊天介面
4. 重新整理頁面
5. 再次檢查

**預期結果**：
- ✅ 點擊清除後，聊天介面立即清空
- ✅ 對話統計顯示 0 則訊息
- ✅ 重新整理後仍然是空的（localStorage 已清除）
- ✅ 不會顯示 "已從瀏覽器載入歷史記錄"

---

### 測試案例 6：不同瀏覽器分頁獨立性
**目的**：驗證不同分頁的對話記錄是共享的（同一瀏覽器）

**步驟**：
1. 在分頁 A 開啟應用程式
2. 輸入訊息：`測試分頁 A`
3. 開啟新分頁 B，訪問相同的應用程式網址
4. 檢查分頁 B 的對話記錄
5. 在分頁 B 重新整理頁面

**預期結果**：
- ✅ 分頁 B 開啟時載入分頁 A 的對話記錄
- ✅ 分頁 B 重新整理後仍顯示相同的對話記錄
- ✅ localStorage 是共享的（同域名、同瀏覽器）

**注意**：這是預期行為，因為 localStorage 是按域名儲存的

---

### 測試案例 7：不同瀏覽器隔離性
**目的**：驗證不同瀏覽器的對話記錄是獨立的

**步驟**：
1. 在 Chrome 開啟應用程式
2. 輸入訊息：`Chrome 測試`
3. 在 Firefox 開啟相同網址
4. 檢查對話記錄

**預期結果**：
- ✅ Firefox 中看不到 Chrome 的對話記錄
- ✅ 兩個瀏覽器的 localStorage 是完全獨立的

---

### 測試案例 8：API 呼叫記錄保留
**目的**：驗證 API 呼叫記錄也會保留

**步驟**：
1. 輸入訊息並等待 AI 回應
2. 點擊左側邊欄的 "📋 API 呼叫記錄"
3. 確認有記錄
4. 重新整理頁面
5. 再次檢查 API 呼叫記錄

**預期結果**：
- ✅ API 呼叫記錄正確顯示
- ✅ 重新整理後 API 記錄保留
- ✅ 記錄包含時間戳記、請求資訊、回應資訊

---

### 測試案例 9：上下文記憶功能
**目的**：驗證 AI 能記住對話上下文

**步驟**：
1. 輸入：`我叫 Lisa`
2. 等待 AI 回應
3. 輸入：`我叫什麼名字？`
4. 檢查 AI 回應

**預期結果**：
- ✅ AI 正確回答使用者名字是 Lisa
- ✅ 證明完整對話歷史有傳送給 API

---

### 測試案例 10：長時間使用後效能
**目的**：驗證大量對話後系統穩定性

**步驟**：
1. 連續輸入 20 則訊息（任意內容）
2. 等待所有 AI 回應
3. 重新整理頁面
4. 檢查載入時間和顯示效能

**預期結果**：
- ✅ 所有 40 則訊息（20 使用者 + 20 AI）完整顯示
- ✅ 頁面載入時間合理（< 5 秒）
- ✅ 捲動和互動流暢

---

## 驗收標準

### 必須通過（P0）
- ✅ 測試案例 3：重新整理頁面後資料保留
- ✅ 測試案例 4：多輪對話後重新整理
- ✅ 測試案例 5：清除對話歷史功能
- ✅ 測試案例 7：不同瀏覽器隔離性

### 應該通過（P1）
- ✅ 測試案例 1：基本對話功能
- ✅ 測試案例 2：localStorage 儲存驗證
- ✅ 測試案例 8：API 呼叫記錄保留
- ✅ 測試案例 9：上下文記憶功能

### 可選通過（P2）
- ✅ 測試案例 6：不同瀏覽器分頁獨立性
- ✅ 測試案例 10：長時間使用後效能

---

## 已知限制

1. **localStorage 容量限制**：
   - 大多數瀏覽器限制為 5-10 MB
   - 超過容量時可能需要清除舊記錄

2. **隱私模式**：
   - 無痕/私密瀏覽模式下 localStorage 可能無效
   - 關閉分頁後資料會被清除

3. **跨裝置同步**：
   - localStorage 不會跨裝置同步
   - 不同電腦/手機的對話記錄是獨立的

---

## 測試報告範本

### 測試執行記錄

**測試日期**：_________
**測試人員**：_________
**瀏覽器**：_________ (版本: _________)
**作業系統**：_________

| 測試案例 | 狀態 | 備註 |
|---------|------|------|
| 案例 1 | ☐ 通過 ☐ 失敗 | |
| 案例 2 | ☐ 通過 ☐ 失敗 | |
| 案例 3 | ☐ 通過 ☐ 失敗 | |
| 案例 4 | ☐ 通過 ☐ 失敗 | |
| 案例 5 | ☐ 通過 ☐ 失敗 | |
| 案例 6 | ☐ 通過 ☐ 失敗 | |
| 案例 7 | ☐ 通過 ☐ 失敗 | |
| 案例 8 | ☐ 通過 ☐ 失敗 | |
| 案例 9 | ☐ 通過 ☐ 失敗 | |
| 案例 10 | ☐ 通過 ☐ 失敗 | |

**整體評估**：☐ 通過 ☐ 需修正

**發現的問題**：
1.
2.
3.

**建議**：
1.
2.
3.
